% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={PS4 Spatial},
  pdfauthor={Claudia Felipe and Francesca Leon},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{PS4 Spatial}
\author{Claudia Felipe and Francesca Leon}
\date{}

\begin{document}
\maketitle

\RecustomVerbatimEnvironment{verbatim}{Verbatim}{
  showspaces = false,
  showtabs = false,
  breaksymbolleft={},
  breaklines
}


\textbf{PS4:} Due Sat Nov 2 at 5:00PM Central. Worth 100 points.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  This problem set is a paired problem set.
\item
  Play paper, scissors, rock to determine who goes first. Call that
  person Partner 1. • Partner 1 (name and cnet ID): Francesca Leon
  (francescaleon) • Partner 2 (name and cnet ID): Claudia Felipe
  (claudiafelipe)
\item
  Partner 1 will accept the ps4 and then share the link it creates with
  their partner. You can only share it with one partner so you will not
  be able to change it after your partner has accepted.
\item
  ``This submission is our work alone and complies with the 30538
  integrity policy.'' Add your initials to indicate your agreement:
  \textbf{CF} \textbf{FL}
\item
  ``I have uploaded the names of anyone else other than my partner and I
  worked with on the problem set here'' (1 point)
\item
  Late coins used this pset: \textbf{0} Late coins left after
  submission: \textbf{4}
\end{enumerate}

\subsection{Style Points (10 pts)}\label{style-points-10-pts}

\subsection{Submission Steps (10 pts)}\label{submission-steps-10-pts}

\subsection{Download and explore the Provider of Services (POS) file (10
pts)}\label{download-and-explore-the-provider-of-services-pos-file-10-pts}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The variables I pulled are: PRVDR\_CTGRY\_SBTYP\_CD, PRVDR\_CTGRY\_CD,
  FAC\_NAME, PRVDR\_NUM, STATE\_CD, PGM\_TRMNTN\_CD, ZIP\_CD.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ altair }\ImportTok{as}\NormalTok{ alt}
\ImportTok{import}\NormalTok{ time}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ warnings}
\ImportTok{import}\NormalTok{ geopandas }\ImportTok{as}\NormalTok{ gpd}
\ImportTok{import}\NormalTok{ os}

\NormalTok{warnings.filterwarnings(}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{)}
\CommentTok{\#alt.renderers.enable(\textquotesingle{}png\textquotesingle{})}
\NormalTok{alt.data\_transformers.disable\_max\_rows()}

\NormalTok{base\_directory }\OperatorTok{=} \StringTok{\textquotesingle{}C:/Users/clfel/Documents/GitHub/problem{-}set{-}4{-}fran{-}clau\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
\end{enumerate}

\hfill\break
a. The number of hospitals reported are 7,245. This number doesn't make
full sense because seems to be too high.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pos2016 }\OperatorTok{=}\NormalTok{ pd.read\_csv(os.path.join(base\_directory, }\StringTok{\textquotesingle{}pos2016.csv\textquotesingle{}}\NormalTok{))}
\NormalTok{pos2016 }\OperatorTok{=}\NormalTok{ pos2016[(pos2016[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (pos2016[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_SBTYP\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{)]}
\NormalTok{pos2016[}\StringTok{\textquotesingle{}year\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{2016}

\NormalTok{pos2016[}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{].nunique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
7245
\end{verbatim}

\hfill\break
b. Based on the American Hospital Association Statistics, the number of
short term hospitals in 2018 (oldest available report) was 4,840. This
number differs significantly from the number calculated using the
database (7,245). This could happen because the hospitals are mistakenly
categorized as short-term in the database. Another explanation could be
that some of the short-term hospitals are closed but still appear in the
database.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pos2017 }\OperatorTok{=}\NormalTok{ pd.read\_csv(os.path.join(base\_directory, }\StringTok{\textquotesingle{}pos2017.csv\textquotesingle{}}\NormalTok{))}
\NormalTok{pos2017 }\OperatorTok{=}\NormalTok{ pos2017[(pos2017[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (pos2017[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_SBTYP\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{)]}
\NormalTok{pos2017[}\StringTok{\textquotesingle{}year\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{2017}

\NormalTok{pos2018 }\OperatorTok{=}\NormalTok{ pd.read\_csv(os.path.join(base\_directory, }\StringTok{\textquotesingle{}pos2018.csv\textquotesingle{}}\NormalTok{), encoding}\OperatorTok{=}\StringTok{"ISO{-}8859{-}1"}\NormalTok{)}
\NormalTok{pos2018 }\OperatorTok{=}\NormalTok{ pos2018[(pos2018[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (pos2018[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_SBTYP\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{)]}
\NormalTok{pos2018[}\StringTok{\textquotesingle{}year\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{2018}

\NormalTok{pos2019 }\OperatorTok{=}\NormalTok{ pd.read\_csv(os.path.join(base\_directory, }\StringTok{\textquotesingle{}pos2019.csv\textquotesingle{}}\NormalTok{), encoding}\OperatorTok{=}\StringTok{"ISO{-}8859{-}1"}\NormalTok{)}
\NormalTok{pos2019 }\OperatorTok{=}\NormalTok{ pos2019[(pos2019[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (pos2019[}\StringTok{\textquotesingle{}PRVDR\_CTGRY\_SBTYP\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{)]}
\NormalTok{pos2019[}\StringTok{\textquotesingle{}year\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{2019}

\NormalTok{pos }\OperatorTok{=}\NormalTok{ pd.concat([pos2016, pos2017, pos2018, pos2019], ignore\_index}\OperatorTok{=}\VariableTok{True}\NormalTok{)}


\NormalTok{alt.Chart(pos, title }\OperatorTok{=} \StringTok{\textquotesingle{}Number of Observations per Year\textquotesingle{}}\NormalTok{).mark\_bar().encode(}
\NormalTok{  alt.X(}\StringTok{\textquotesingle{}year:O\textquotesingle{}}\NormalTok{).title(}\StringTok{\textquotesingle{}Year\textquotesingle{}}\NormalTok{),}
\NormalTok{  alt.Y(}\StringTok{\textquotesingle{}count():Q\textquotesingle{}}\NormalTok{).title(}\StringTok{\textquotesingle{}Number of Observations\textquotesingle{}}\NormalTok{)}
\NormalTok{).properties(width }\OperatorTok{=} \DecValTok{500}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
alt.Chart(...)
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
\end{enumerate}

\hfill\break
a.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alt.Chart(pos, title }\OperatorTok{=} \StringTok{\textquotesingle{}Number of Unique Hospitals per Year\textquotesingle{}}\NormalTok{).mark\_bar().encode(}
\NormalTok{  alt.X(}\StringTok{\textquotesingle{}year:O\textquotesingle{}}\NormalTok{).title(}\StringTok{\textquotesingle{}Year\textquotesingle{}}\NormalTok{),}
\NormalTok{  alt.Y(}\StringTok{\textquotesingle{}distinct(PRVDR\_NUM):Q\textquotesingle{}}\NormalTok{).title(}\StringTok{\textquotesingle{}Number of Unique Hospitals\textquotesingle{}}\NormalTok{)}
\NormalTok{).properties(width }\OperatorTok{=} \DecValTok{500}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
alt.Chart(...)
\end{verbatim}

\hfill\break
b. The graphs are the same, with the same numbers. This means that the
database contains the same number of observations and unique hospitals.
This tells that the structure of the data is attached to the unique
hospitals, those being the unit of observation.

\subsection{Identify hospital closures in POS file (15 pts)
(*)}\label{identify-hospital-closures-in-pos-file-15-pts}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The total suspected hospital closures is 174.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Filter active hospitals in 2016}
\NormalTok{active\_2016 }\OperatorTok{=}\NormalTok{ pos2016[pos2016[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{][[}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{]]}

\CommentTok{\# Create a list to store the suspected closure year}
\NormalTok{closure\_data }\OperatorTok{=}\NormalTok{ []}

\CommentTok{\# Iterate over each hospital active in 2016 and check if it remains active in the following years}
\ControlFlowTok{for}\NormalTok{ \_, row }\KeywordTok{in}\NormalTok{ active\_2016.iterrows():}
\NormalTok{    provider\_id }\OperatorTok{=}\NormalTok{ row[}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{]}
\NormalTok{    facility\_name }\OperatorTok{=}\NormalTok{ row[}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{]}
\NormalTok{    zip\_code }\OperatorTok{=}\NormalTok{ row[}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{]}
    
    \CommentTok{\# Check each successive year}
    \ControlFlowTok{if}\NormalTok{ provider\_id }\KeywordTok{not} \KeywordTok{in}\NormalTok{ pos2017[pos2017[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{][}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{].values:}
\NormalTok{        closure\_data.append([facility\_name, zip\_code, }\DecValTok{2017}\NormalTok{])}
    \ControlFlowTok{elif}\NormalTok{ provider\_id }\KeywordTok{not} \KeywordTok{in}\NormalTok{ pos2018[pos2018[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{][}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{].values:}
\NormalTok{        closure\_data.append([facility\_name, zip\_code, }\DecValTok{2018}\NormalTok{])}
    \ControlFlowTok{elif}\NormalTok{ provider\_id }\KeywordTok{not} \KeywordTok{in}\NormalTok{ pos2019[pos2019[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{][}\StringTok{\textquotesingle{}PRVDR\_NUM\textquotesingle{}}\NormalTok{].values:}
\NormalTok{        closure\_data.append([facility\_name, zip\_code, }\DecValTok{2019}\NormalTok{])}

\CommentTok{\# Convert the results into a DataFrame}
\NormalTok{closure\_df }\OperatorTok{=}\NormalTok{ pd.DataFrame(closure\_data, columns}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{])}

\BuiltInTok{print}\NormalTok{(}\StringTok{"Total suspected hospital closures:"}\NormalTok{, closure\_df.shape[}\DecValTok{0}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Total suspected hospital closures: 174
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Sort hospitals by name and select the first 10 rows}
\NormalTok{sorted\_hospitals }\OperatorTok{=}\NormalTok{ closure\_df.sort\_values(by}\OperatorTok{=}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{)[[}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{]].head(}\DecValTok{10}\NormalTok{)}

\CommentTok{\# Display the results}
\NormalTok{sorted\_hospitals.style.hide()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{}\label{T_13f8e}\tabularnewline
\toprule\noalign{}
FAC\_NAME & Year of Susp. Closure \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
FAC\_NAME & Year of Susp. Closure \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
ABRAZO MARYVALE CAMPUS & 2017 \\
ADVENTIST MEDICAL CENTER - CENTRAL VALLEY & 2017 \\
AFFINITY MEDICAL CENTER & 2018 \\
ALBANY MEDICAL CENTER / SOUTH CLINICAL CAMPUS & 2017 \\
ALLEGIANCE SPECIALTY HOSPITAL OF KILGORE & 2017 \\
ALLIANCE LAIRD HOSPITAL & 2019 \\
ALLIANCEHEALTH DEACONESS & 2019 \\
ANNE BATES LEACH EYE HOSPITAL & 2019 \\
ARKANSAS VALLEY REGIONAL MEDICAL CENTER & 2017 \\
BANNER CHURCHILL COMMUNITY HOSPITAL & 2017 \\
\end{longtable}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Count the total number of active hospitals by ZIP code for each year}
\NormalTok{active\_by\_zip\_2016 }\OperatorTok{=}\NormalTok{ pos2016[pos2016[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{].groupby(}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{).size().to\_dict()}
\NormalTok{active\_by\_zip\_2017 }\OperatorTok{=}\NormalTok{ pos2017[pos2017[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{].groupby(}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{).size().to\_dict()}
\NormalTok{active\_by\_zip\_2018 }\OperatorTok{=}\NormalTok{ pos2018[pos2018[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{].groupby(}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{).size().to\_dict()}
\NormalTok{active\_by\_zip\_2019 }\OperatorTok{=}\NormalTok{ pos2019[pos2019[}\StringTok{\textquotesingle{}PGM\_TRMNTN\_CD\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{0}\NormalTok{].groupby(}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{).size().to\_dict()}

\CommentTok{\# Create a DataFrame from the dictionaries}
\NormalTok{active\_counts\_df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}
    \StringTok{\textquotesingle{}2016\textquotesingle{}}\NormalTok{: pd.Series(active\_by\_zip\_2016),}
    \StringTok{\textquotesingle{}2017\textquotesingle{}}\NormalTok{: pd.Series(active\_by\_zip\_2017),}
    \StringTok{\textquotesingle{}2018\textquotesingle{}}\NormalTok{: pd.Series(active\_by\_zip\_2018),}
    \StringTok{\textquotesingle{}2019\textquotesingle{}}\NormalTok{: pd.Series(active\_by\_zip\_2019)}
\NormalTok{\})}

\CommentTok{\# Fill any missing values with 0, in case a ZIP code has no active hospitals in a given year}
\NormalTok{active\_counts\_df }\OperatorTok{=}\NormalTok{ active\_counts\_df.fillna(}\DecValTok{0}\NormalTok{).astype(}\BuiltInTok{int}\NormalTok{)}

\CommentTok{\# Create new columns for the difference in active hospital counts between consecutive years}
\NormalTok{active\_counts\_df[}\StringTok{\textquotesingle{}2017{-}2016\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2017\textquotesingle{}}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2016\textquotesingle{}}\NormalTok{]}
\NormalTok{active\_counts\_df[}\StringTok{\textquotesingle{}2018{-}2017\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2018\textquotesingle{}}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2017\textquotesingle{}}\NormalTok{]}
\NormalTok{active\_counts\_df[}\StringTok{\textquotesingle{}2019{-}2018\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2019\textquotesingle{}}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ active\_counts\_df[}\StringTok{\textquotesingle{}2018\textquotesingle{}}\NormalTok{]}

\NormalTok{active\_counts\_df }\OperatorTok{=}\NormalTok{ active\_counts\_df.reset\_index()}
\NormalTok{active\_counts\_df }\OperatorTok{=}\NormalTok{ active\_counts\_df.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}index\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{\})}

\CommentTok{\# Perform the merge on \textquotesingle{}ZIP\_CD\textquotesingle{}}
\NormalTok{merged\_df }\OperatorTok{=}\NormalTok{ pd.merge(closure\_df, active\_counts\_df, on}\OperatorTok{=}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{)}

\CommentTok{\#}
\NormalTok{merged\_df[}\StringTok{\textquotesingle{}change\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ np.where(}
\NormalTok{    merged\_df[}\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{2017}\NormalTok{, merged\_df[}\StringTok{\textquotesingle{}2017{-}2016\textquotesingle{}}\NormalTok{],}
\NormalTok{    np.where(}
\NormalTok{        merged\_df[}\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{2018}\NormalTok{, merged\_df[}\StringTok{\textquotesingle{}2018{-}2017\textquotesingle{}}\NormalTok{],}
\NormalTok{        np.where(}
\NormalTok{            merged\_df[}\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \DecValTok{2019}\NormalTok{, merged\_df[}\StringTok{\textquotesingle{}2019{-}2018\textquotesingle{}}\NormalTok{],}
\NormalTok{            np.nan  }
\NormalTok{        )}
\NormalTok{    )}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  The number of hospitals potentially merged/acquired is 8
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Possible mergers or acquisitions: hospitals with "change" \textless{}= 0}
\NormalTok{merged\_or\_acquisition }\OperatorTok{=}\NormalTok{ merged\_df[(merged\_df[}\StringTok{\textquotesingle{}change\textquotesingle{}}\NormalTok{] }\OperatorTok{\textgreater{}=} \DecValTok{0}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (merged\_df[}\StringTok{\textquotesingle{}change\textquotesingle{}}\NormalTok{].notna())]}
\NormalTok{n\_merged }\OperatorTok{=}\NormalTok{ merged\_or\_acquisition.shape[}\DecValTok{0}\NormalTok{]}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Number of hospitals potentially merged/acquired:"}\NormalTok{, n\_merged)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Number of hospitals potentially merged/acquired: 8
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Remaining valid closures with "change" \textgreater{}= 1}
\NormalTok{df\_corrected }\OperatorTok{=}\NormalTok{ merged\_df[(merged\_df[}\StringTok{\textquotesingle{}change\textquotesingle{}}\NormalTok{] }\OperatorTok{\textless{}} \DecValTok{0}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (merged\_df[}\StringTok{\textquotesingle{}change\textquotesingle{}}\NormalTok{].notna())]}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Remaining valid closures after excluding mergers/acquisitions:"}\NormalTok{, df\_corrected.shape[}\DecValTok{0}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Remaining valid closures after excluding mergers/acquisitions: 166
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  The remaining valid closures after excluding mergers/acquisitions is
  166.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Sort the corrected DataFrame by hospital name and display the first 10 rows}

\NormalTok{sorted\_corrected\_closures }\OperatorTok{=}\NormalTok{ df\_corrected.sort\_values(by}\OperatorTok{=}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{)[[}\StringTok{\textquotesingle{}FAC\_NAME\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Year of Susp. Closure\textquotesingle{}}\NormalTok{]].head(}\DecValTok{10}\NormalTok{)}
\NormalTok{sorted\_corrected\_closures[}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{]}\OperatorTok{=}\NormalTok{sorted\_corrected\_closures[}\StringTok{\textquotesingle{}ZIP\_CD\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{int}\NormalTok{)}
\NormalTok{sorted\_corrected\_closures.style.hide()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lll@{}}
\caption{}\label{T_3df21}\tabularnewline
\toprule\noalign{}
FAC\_NAME & ZIP\_CD & Year of Susp. Closure \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
FAC\_NAME & ZIP\_CD & Year of Susp. Closure \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
ABRAZO MARYVALE CAMPUS & 85031 & 2017 \\
ADVENTIST MEDICAL CENTER - CENTRAL VALLEY & 93230 & 2017 \\
AFFINITY MEDICAL CENTER & 44646 & 2018 \\
ALBANY MEDICAL CENTER / SOUTH CLINICAL CAMPUS & 12208 & 2017 \\
ALLEGIANCE SPECIALTY HOSPITAL OF KILGORE & 75662 & 2017 \\
ALLIANCE LAIRD HOSPITAL & 39365 & 2019 \\
ALLIANCEHEALTH DEACONESS & 73112 & 2019 \\
ANNE BATES LEACH EYE HOSPITAL & 33136 & 2019 \\
ARKANSAS VALLEY REGIONAL MEDICAL CENTER & 81050 & 2017 \\
BANNER CHURCHILL COMMUNITY HOSPITAL & 89406 & 2017 \\
\end{longtable}

\subsection{Download Census zip code shapefile (10
pt)}\label{download-census-zip-code-shapefile-10-pt}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
  \item
  \end{enumerate}
\item
\end{enumerate}

\subsection{Calculate zip code's distance to the nearest hospital (20
pts)
(*)}\label{calculate-zip-codes-distance-to-the-nearest-hospital-20-pts}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
\item
\item
\item
  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
  \item
  \item
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
  \item
  \item
  \end{enumerate}
\end{enumerate}

\subsection{Effects of closures on access in Texas (15
pts)}\label{effects-of-closures-on-access-in-texas-15-pts}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
\item
\item
\item
\end{enumerate}

\subsection{Reflecting on the exercise (10
pts)}\label{reflecting-on-the-exercise-10-pts}




\end{document}
